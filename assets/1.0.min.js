function postmate(e,t){return new Promise(function(n,i){var o=new XMLHttpRequest;o.open("POST",t,!0),o.setRequestHeader("content-type","application/json;charset=UTF-8"),o.onload=function(){200===o.status?n(o.responseText):i(o.statusText)},o.onerror=function(){i(Error("Could not make XMLHttpRequest"))},o.send(JSON.stringify(e))})}function cookier(e){var t=document.cookie.match("(^|;)\\s*"+e+"\\s*=\\s*([^;]+)");return t?t.pop():""}function cookiew(e,t){document.cookie=e+"="+t+"; max-age=60"}function show(e){for(var t=0;t<e.length;t++)e[t].style.display="unset"}function hide(e){for(var t=0;t<e.length;t++)e[t].style.display="none"}function inform(e,t){e.innerHTML=t}(function(){var e,t;e=this,t=function(){var e={startStopTimes:{},idleTimeoutMs:3e4,currentIdleTimeMs:0,checkStateRateMs:250,active:!1,idle:!1,timeElapsedCallbacks:[],userLeftCallbacks:[],userReturnCallbacks:[],trackTimeOnElement:function(t){var n=document.getElementById(t);n&&(n.addEventListener("mouseover",function(){e.startTimer(t)}),n.addEventListener("mousemove",function(){e.startTimer(t)}),n.addEventListener("mouseleave",function(){e.stopTimer(t)}),n.addEventListener("keypress",function(){e.startTimer(t)}),n.addEventListener("focus",function(){e.startTimer(t)}))},getTimeOnElementInSeconds:function(t){var n=e.getTimeOnPageInSeconds(t);return n||0},startTimer:function(t){if(t||(t="payg"),void 0===e.startStopTimes[t])e.startStopTimes[t]=[];else{var n=e.startStopTimes[t],i=n[n.length-1];if(void 0!==i&&void 0===i.stopTime)return}e.startStopTimes[t].push({startTime:new Date,stopTime:void 0}),e.active=!0},stopAllTimers:function(){for(var t=Object.keys(e.startStopTimes),n=0;n<t.length;n++)e.stopTimer(t[n])},stopTimer:function(t){t||(t="payg");var n=e.startStopTimes[t];void 0!==n&&0!==n.length&&(void 0===n[n.length-1].stopTime&&(n[n.length-1].stopTime=new Date),e.active=!1)},getTimeOnCurrentPageInSeconds:function(){return e.getTimeOnPageInSeconds("payg")},getTimeOnPageInSeconds:function(t){return void 0===e.getTimeOnPageInMilliseconds(t)?void 0:e.getTimeOnPageInMilliseconds(t)/1e3},getTimeOnCurrentPageInMilliseconds:function(){return e.getTimeOnPageInMilliseconds("payg")},getTimeOnPageInMilliseconds:function(t){var n=e.startStopTimes[t];if(void 0!==n){for(var i=0,o=0;o<n.length;o++){var s=n[o].startTime,a=n[o].stopTime;void 0===a&&(a=new Date),i+=a-s}return Number(i)}},getTimeOnAllPagesInSeconds:function(){for(var t=[],n=Object.keys(e.startStopTimes),i=0;i<n.length;i++){var o=n[i],s=e.getTimeOnPageInSeconds(o);t.push({pageName:o,timeOnPage:s})}return t},setIdleDurationInSeconds:function(t){var n=parseFloat(t);if(!1!==isNaN(n))throw{name:"InvalidDurationException",message:"An invalid duration time ("+t+") was provided."};return e.idleTimeoutMs=1e3*t,this},resetRecordedPageTime:function(t){delete e.startStopTimes[t]},resetAllRecordedPageTimes:function(){for(var t=Object.keys(e.startStopTimes),n=0;n<t.length;n++)e.resetRecordedPageTime(t[n])},resetIdleCountdown:function(){e.idle&&e.triggerUserHasReturned(),e.idle=!1,e.currentIdleTimeMs=0},callWhenUserLeaves:function(e,t){this.userLeftCallbacks.push({callback:e,numberOfTimesToInvoke:t})},callWhenUserReturns:function(e,t){this.userReturnCallbacks.push({callback:e,numberOfTimesToInvoke:t})},triggerUserHasReturned:function(){if(!e.active)for(var t=0;t<this.userReturnCallbacks.length;t++){var n=this.userReturnCallbacks[t],i=n.numberOfTimesToInvoke;(isNaN(i)||void 0===i||i>0)&&(n.numberOfTimesToInvoke-=1,n.callback())}e.startTimer()},triggerUserHasLeftPage:function(){if(e.active)for(var t=0;t<this.userLeftCallbacks.length;t++){var n=this.userLeftCallbacks[t],i=n.numberOfTimesToInvoke;(isNaN(i)||void 0===i||i>0)&&(n.numberOfTimesToInvoke-=1,n.callback())}e.stopAllTimers()},callAfterTimeElapsedInSeconds:function(t,n){e.timeElapsedCallbacks.push({timeInSeconds:t,callback:n,pending:!0})},checkState:function(){for(var t=0;t<e.timeElapsedCallbacks.length;t++)e.timeElapsedCallbacks[t].pending&&e.getTimeOnCurrentPageInSeconds()>e.timeElapsedCallbacks[t].timeInSeconds&&(e.timeElapsedCallbacks[t].callback(),e.timeElapsedCallbacks[t].pending=!1);!1===e.idle&&e.currentIdleTimeMs>e.idleTimeoutMs?(e.idle=!0,e.triggerUserHasLeftPage()):e.currentIdleTimeMs+=e.checkStateRateMs},visibilityChangeEventName:void 0,hiddenPropName:void 0,listenForVisibilityEvents:function(){void 0!==document.hidden?(e.hiddenPropName="hidden",e.visibilityChangeEventName="visibilitychange"):void 0!==doc.mozHidden?(e.hiddenPropName="mozHidden",e.visibilityChangeEventName="mozvisibilitychange"):void 0!==document.msHidden?(e.hiddenPropName="msHidden",e.visibilityChangeEventName="msvisibilitychange"):void 0!==document.webkitHidden&&(e.hiddenPropName="webkitHidden",e.visibilityChangeEventName="webkitvisibilitychange"),document.addEventListener(e.visibilityChangeEventName,function(){document[e.hiddenPropName]?e.triggerUserHasLeftPage():e.triggerUserHasReturned()},!1),window.addEventListener("blur",function(){e.triggerUserHasLeftPage()}),window.addEventListener("focus",function(){e.triggerUserHasReturned()}),document.addEventListener("mousemove",function(){e.resetIdleCountdown()}),document.addEventListener("keyup",function(){e.resetIdleCountdown()}),document.addEventListener("touchstart",function(){e.resetIdleCountdown()}),window.addEventListener("scroll",function(){e.resetIdleCountdown()}),setInterval(function(){e.checkState()},e.checkStateRateMs)},initialize:function(t){var n=e.idleTimeoutMs||30;t&&(n=t.idleTimeoutInSeconds||n),e.setIdleDurationInSeconds(n).listenForVisibilityEvents(),e.startTimer()}};return e},"undefined"!=typeof module&&module.exports?module.exports=t():"function"==typeof define&&define.amd?define([],function(){return e.pt=t()}):e.pt=t()}).call(this),window.addEventListener("load",function(){pt.initialize({idleTimeoutInSeconds:30});var e={},t=null,n=null,i=String(document.location),o=document.getElementById("empayg-display"),s=o.getAttribute("data-revenueid"),a=o.getAttribute("data-position"),r=o.getAttribute("data-text");r||(r="");for(var l=document.getElementsByClassName("empayg-content"),d=document.getElementsByClassName("empayg-infomercial"),u=document.getElementsByClassName("empayg-protect"),c=0;c<u.length;c++)u[c].setAttribute("style","-webkit-user-select:none; -khtml-user-select:none; -moz-user-select:none; -ms-user-select:none; -o-user-select:none; user-select:none; "),u[c].style.pointerEvents="none";hide(l),o.innerHTML="<span id='empayg-info'></span><span style='float:right; text-align:right;'><form id='empayg-login' onsubmit='return false;'><input id='empayg-mail' class='empayg-input' size='20' placeholder='email' type='email'><input id='empayg-key' class='empayg-input' size='8' placeholder='key' type='password'><span id='button-group'><button id='empayg-signin' class='empayg-button' type='submit'>Login</button><button id='empayg-signin-tent' class='empayg-button' type='button' >Login</button><button id='empayg-signup' class='empayg-button' type='button'>Signup</button><button id='empayg-signout' class='empayg-button' type='button'>Log Out</button></span></form></span>",o.style.display="block",o.style.overflow="hidden",o.style.backgroundColor="#ffc107",o.style.minHeight="32px",o.style.width="100%",o.style.zIndex="1000",o.style.color="#ffffff",o.style.padding="3px 6px",o.style.height="auto",o.style.fontFamily='-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol"',o.style.fontStyle="normal",o.style.fontSize="medium";var p=document.getElementById("empayg-info"),m=document.getElementById("empayg-login"),g=document.getElementsByClassName("empayg-input"),y=document.getElementById("button-group"),f=document.getElementsByClassName("empayg-button"),v=document.getElementById("empayg-mail"),h=document.getElementById("empayg-key"),b=document.getElementById("empayg-signin-tent"),T=document.getElementById("empayg-signin"),k=document.getElementById("empayg-signup"),E=document.getElementById("empayg-signout");p.style.color="white",p.style.textDecoration="none",p.style.fontWeight="bold",m.style.display="inline-block";for(c=0;c<g.length;c++)g[c].style.display="none",g[c].style.padding="1px 6px",g[c].style.height="30px",g[c].style.margin="3px",g[c].style.backgroundColor="white",g[c].style.borderRadius="4px";y.style.display="inline-block";for(c=0;c<f.length;c++)f[c].style.display="none",f[c].style.padding="1px 6px",f[c].style.border="solid",f[c].style.height="30px",f[c].style.borderWidth="1px",f[c].style.borderColor="white",f[c].style.color="white",f[c].style.fontWeight="bold",f[c].style.background="inherit",f[c].style.margin="3px",f[c].style.borderRadius="4px";var I=document.createEvent("Event");I.initEvent("unfold",!0,!0);var w=document.createEvent("Event");w.initEvent("fold",!0,!0),o.addEventListener("unfold",function(i){if(clearInterval(n),e.uid){cookiew("empayguid",e.uid),cookiew("empaygser",window.btoa(e.user)),show(l),hide(d),v.value="",h.value="",o.style.position=null,inform(p,e.user),hide([v,h,b,T,k]),E.textContent="Log Out",show([E]);var s=pt.getTimeOnCurrentPageInSeconds(),a=10,r=0;t&&clearInterval(t),t=setInterval(function(){a--<0&&o.dispatchEvent(w),r=Math.round(pt.getTimeOnCurrentPageInSeconds()-s),postmate({uid:e.uid,charge:r},"https://empayg.net/r/session").then(function(t){"no"==t?o.dispatchEvent(w):"ok"==t&&(s+=r,a=10,cookiew("empayguid",e.uid),cookiew("empaygser",window.btoa(e.user)))})},5e3)}else o.dispatchEvent(w)},!1),o.addEventListener("fold",function(i){n&&clearInterval(n),n=setInterval(function(){hide(l),show(d)},10),clearInterval(t),"bottom"==a&&(o.style.position="fixed",o.style.bottom="0",o.style.left="0",o.style.right="0",document.getElementsByTagName("body")[0].style.marginBottom="60px"),inform(p,"EMPAYG. "+r),hide([v,h,T,E]),show([b,k]),E.textContent="Log Out",e.uid=!1,e.user=!1},!1),e.uid=cookier("empayguid"),e.user=window.atob(cookier("empaygser")),e.uid&&e.user?(hide(d),postmate({uid:e.uid,charge:0},"https://empayg.net/r/session").then(function(e){"ok"==e?o.dispatchEvent(I):o.dispatchEvent(w)})):o.dispatchEvent(w),b.onclick=function(){postmate({service:s},"https://empayg.net/q/service").then(function(e){if("na"==e)inform(p,"Could not find "+s);else{var t=JSON.parse(e);inform(p,'<small>EMPAYG.<br></small><span style="font-size:125%">'+t.service+" "+t.deal+'</span><span style="display:block">by '+t.seller+" : "+t.details+"</span>")}}),show([v,h,T,E]),hide([b,k]),E.textContent="Cancel"},T.onclick=function(){var t=v.value.toLowerCase(),n=h.value;t&&/\S+@\S+\.\S+/.test(t)&&n?postmate({m:t,k:n,s:s,l:i},"https://empayg.net/r/hash").then(function(n){"no"==n||"se"==n?inform(p,"Could not start a session. Please contact support."):"us"==n||"ke"==n?inform(p,"Invalid credentials. Please check your email and key."):"ba"==n?inform(p,"Insufficient balance. Kindly update your card at empayg.com."):(e.uid=n,e.user=t,o.dispatchEvent(I))}):/\S+@\S+\.\S+/.test(t)?inform(p,n?"Something went wrong. Please contact us at support@empayg.com":"Enter a key"):inform(p,"Enter a valid email")},k.onclick=function(){window.location="https://empayg.com/signup?next="+window.location.href},E.onclick=function(){cookiew("empayguid",""),cookiew("empaygser",""),o.dispatchEvent(w)}});
